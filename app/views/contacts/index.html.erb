<h1>Your Contacts</h1>

<%# current_user = AppEngine::Users.current_user %>
<% current_user = session[:current_user_id] %>

<table>
  <tr><thead>
    <th>Name</th>
    <th>Number</th>
    <th>Im</th>
	<th colspan="5">&nbsp;</th>
	</thead>
  </tr>

<% if @contacts %>
<% @contacts.each do |contact| %>
  <tr>
    <td><%=h contact.contactname %></td>
    <td><%=h contact.number %></td>
    <td><%=h contact.im %></td>
    <td><%= link_to 'Call', new_voice_call_path(current_user, { :to => contact.number }) %></td>
    <td><%= link_to 'SMS', new_messaging_path(current_user, { :to => contact.number }) %></td>
    <td><%= link_to 'Show', contact_path(contact) %></td>
    <td><%= link_to 'Edit', edit_contact_path(contact) %></td>
    <td><%= link_to 'Delete', contact_path(contact), :confirm => 'Are you sure?', :method => :delete %></td>
  </tr>
<% end %>
<% end %>
</table>

<p>
<% @page = params[:page] %>
<% if @page.nil?  %>
<% @page = 1 %>
<% end %>

<% if @page = 1 and @contacts.paginator.page_count.to_i > 1 %>
<%= @contacts.paginator.page %>
| <%= link_to 'First Page', '/contacts?page=1' %> 
<% end %>

<% if @page.to_i > 1 %>
 | <%= link_to '<< Previous Page', '/contacts?page=' + (@contacts.paginator.page - 1).to_s %> 
<% end %>

<% if @page.to_i < @contacts.paginator.page_count %>
 | <%= link_to 'Next Page >>', '/contacts?page=' + (@contacts.paginator.page + 1).to_s %> 
<% end %>

<% if @page.to_i != @contacts.paginator.page_count and @contacts.paginator.page_count.to_i > 1 %>
 | <%= link_to 'Last Page', '/contacts?page=' + @contacts.paginator.page_count.to_s %> 
<% end %>
</p>

<%= link_to 'New contact', new_contact_path %>