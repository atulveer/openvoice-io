<% current_user = session[:current_user_id] %>
<h1>Your Messages (sms/im)</h1>

<table>
  <tr><thead>
    <th>From</th>
    <th>To</th>
    <th>Text</th>
    <th>Time</th>
	<th colspan="3">&nbsp;</th>
</thead>
  </tr>

<% if @messagings %>
<% @messagings.each do |messaging| %>
  <tr>
    <td><%=h messaging.from %></td>
    <td><%=h messaging.to %></td>
    <td><%=h messaging.text %></td>
    <td><%=h messaging.created_at %></td>
    <td><%= link_to 'Reply', new_messaging_path({ :to => messaging.from }) %></td>
    <td><%= link_to 'Show', messaging_path(messaging) %></td>
    <td><%= link_to 'Delete', messaging_path(messaging), :confirm => 'Are you sure?', :method => :delete %></td>
  </tr>
<% end %>
<% end %>
</table>

<p>
<% @page = params[:page] %>
<% if @page.nil?  %>
<% @page = 1 %>
<% end %>

<% if @page = 1 and @messagings.paginator.page_count.to_i > 1 %>
<%= @messagings.paginator.page %>
| <%= link_to 'First Page', '/messagings?page=1' %> 
<% end %>

<% if @page.to_i > 1 %>
 | <%= link_to '<< Previous Page', '/messagings?page=' + (@messagings.paginator.page - 1).to_s %> 
<% end %>

<% if @page.to_i < @messagings.paginator.page_count %>
 | <%= link_to 'Next Page >>', '/messagings?page=' + (@messagings.paginator.page + 1).to_s %> 
<% end %>

<% if @page.to_i != @messagings.paginator.page_count and @messagings.paginator.page_count.to_i > 1 %>
 | <%= link_to 'Last Page', '/messagings?page=' + @messagings.paginator.page_count.to_s  %> 
<% end %>
</p>

<%= link_to 'new message', new_messaging_path %>